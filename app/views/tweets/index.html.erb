<div class="row">
  <div class="col-md-2">
    <%= render partial: "form" %>
  </div>
  
  <div class="col-md-4">
    <ul class="tweets list-group">
      <% @tweets.each do |tweet|%>
      <li class="tweet list-group-item">
        <%= tweet.screen_name %> - <%= tweet.created_at%><br><br>
        <%= tweet.text %>
      </li>
      <%end%>
    </ul>
    <%= paginate @tweets %>
  </div>

  <div class="col-md-6">
    <div id="map-canvas"></div>
  </div>



  <!-- google map -->

  <script type="text/javascript">
    function initialize() {
      var center = new google.maps.LatLng(<%= @lat %>, <%= @long %>);
      var mapOptions = {
        center: center,
        zoom: 7
      };
      var map = new google.maps.Map(document.getElementById("map-canvas"),
          mapOptions);
    
      var geoCircle = new google.maps.Circle({
        strokeColor: '#FF0000',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#FF0000',
        fillOpacity: 0.15,
        map: map,
        center: center,
        radius: <%= @radius * 3959 * 1609 %> //convert from miles to meters
      })
    
      var marker = new google.maps.Marker({
        position: center,
        map: map,
        title: "lat:<%=@lat%> long:<%=@long%>",
      });

      <% @tweets.each_with_index do |tweet, idx| %>
        var marker<%=idx%> = new google.maps.Marker({
          position: new google.maps.LatLng(<%=tweet.coordinates[1]%>, <%=tweet.coordinates[0]%>),
          map: map,
          title: "<%= tweet.screen_name %>:<br><br> <%= tweet.text %>"
        });
    
        google.maps.event.addListener(marker<%=idx%>, 'click', function() {
          var infowindow = new google.maps.InfoWindow({
                content: marker<%=idx%>.title,
                maxWidth: 200,
          });
          infowindow.open(map,marker<%=idx%>);
        });
      <% end %>
    }
    google.maps.event.addDomListener(window, 'load', initialize);
  </script>

</div>




